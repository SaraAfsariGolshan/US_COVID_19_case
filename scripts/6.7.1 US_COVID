{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "94bfe182",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import os\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import scipy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b59379e3",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\tamar\\AppData\\Local\\Temp\\ipykernel_22000\\2139121252.py:1: DtypeWarning: Columns (59) have mixed types. Specify dtype option on import or set low_memory=False.\n",
      "  df=pd.read_csv(r\"C:\\Users\\tamar\\Desktop\\career foundry\\part 7\\archive\\covid_us_county.csv\",index_col=False)\n"
     ]
    }
   ],
   "source": [
    "df=pd.read_csv(r\"C:\\Users\\tamar\\Desktop\\career foundry\\part 7\\archive\\covid_us_county.csv\",index_col=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c734cc47",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3612702, 61)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "2b4e5500",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fips</th>\n",
       "      <th>county</th>\n",
       "      <th>state</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "      <th>1/1/23</th>\n",
       "      <th>1/2/23</th>\n",
       "      <th>1/3/23</th>\n",
       "      <th>1/4/23</th>\n",
       "      <th>1/5/23</th>\n",
       "      <th>...</th>\n",
       "      <th>2/19/23</th>\n",
       "      <th>2/23/23</th>\n",
       "      <th>2/24/23</th>\n",
       "      <th>2/25/23</th>\n",
       "      <th>2/26/23</th>\n",
       "      <th>2/27/23</th>\n",
       "      <th>date</th>\n",
       "      <th>cases</th>\n",
       "      <th>state_code</th>\n",
       "      <th>deaths</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>19205</td>\n",
       "      <td>19205</td>\n",
       "      <td>...</td>\n",
       "      <td>19686</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>19205</td>\n",
       "      <td>19205</td>\n",
       "      <td>...</td>\n",
       "      <td>19686</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>2020-01-23</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>19205</td>\n",
       "      <td>19205</td>\n",
       "      <td>...</td>\n",
       "      <td>19686</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>2020-01-24</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>19205</td>\n",
       "      <td>19205</td>\n",
       "      <td>...</td>\n",
       "      <td>19686</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>2020-01-25</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>18961</td>\n",
       "      <td>19205</td>\n",
       "      <td>19205</td>\n",
       "      <td>...</td>\n",
       "      <td>19686</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>19732</td>\n",
       "      <td>2020-01-26</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 61 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     fips   county    state        lat       long  1/1/23  1/2/23  1/3/23  \\\n",
       "0  1001.0  Autauga  Alabama  32.539527 -86.644082   18961   18961   18961   \n",
       "1  1001.0  Autauga  Alabama  32.539527 -86.644082   18961   18961   18961   \n",
       "2  1001.0  Autauga  Alabama  32.539527 -86.644082   18961   18961   18961   \n",
       "3  1001.0  Autauga  Alabama  32.539527 -86.644082   18961   18961   18961   \n",
       "4  1001.0  Autauga  Alabama  32.539527 -86.644082   18961   18961   18961   \n",
       "\n",
       "   1/4/23  1/5/23  ...  2/19/23  2/23/23  2/24/23  2/25/23  2/26/23  2/27/23  \\\n",
       "0   19205   19205  ...    19686    19732    19732    19732    19732    19732   \n",
       "1   19205   19205  ...    19686    19732    19732    19732    19732    19732   \n",
       "2   19205   19205  ...    19686    19732    19732    19732    19732    19732   \n",
       "3   19205   19205  ...    19686    19732    19732    19732    19732    19732   \n",
       "4   19205   19205  ...    19686    19732    19732    19732    19732    19732   \n",
       "\n",
       "         date  cases  state_code  deaths  \n",
       "0  2020-01-22      0          AL       0  \n",
       "1  2020-01-23      0          AL       0  \n",
       "2  2020-01-24      0          AL       0  \n",
       "3  2020-01-25      0          AL       0  \n",
       "4  2020-01-26      0          AL       0  \n",
       "\n",
       "[5 rows x 61 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f91673fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases = df.drop(columns = ['1/1/23',\n",
    " '1/2/23',\n",
    " '1/3/23',\n",
    " '1/4/23',\n",
    " '1/5/23',\n",
    " '1/6/23',\n",
    " '1/7/23',                                             \n",
    " '1/8/23',\n",
    " '1/9/23',\n",
    " '1/10/23',\n",
    " '1/11/23',\n",
    " '1/12/23',\n",
    " '1/13/23',\n",
    " '1/14/23',\n",
    " '1/15/23',\n",
    " '1/16/23',\n",
    " '1/17/23',\n",
    " '1/18/23',\n",
    " '1/19/23',\n",
    " '1/23/23',\n",
    " '1/24/23',\n",
    " '1/25/23',\n",
    " '1/26/23',\n",
    " '1/27/23',\n",
    " '1/28/23',\n",
    " '1/29/23',\n",
    " '1/30/23',\n",
    " '1/31/23',\n",
    " '2/1/23','2/2/23',\n",
    " '2/3/23',\n",
    " '2/4/23',\n",
    " '2/5/23',\n",
    " '2/6/23',\n",
    " '2/7/23',\n",
    " '2/8/23',\n",
    " '2/9/23',\n",
    " '2/10/23',\n",
    " '2/11/23',\n",
    " '2/12/23',\n",
    " '2/13/23',\n",
    " '2/14/23',\n",
    " '2/15/23',\n",
    " '2/16/23',\n",
    " '2/17/23',\n",
    " '2/18/23',\n",
    " '2/19/23',\n",
    " '2/23/23',\n",
    " '2/24/23',\n",
    " '2/25/23',\n",
    " '2/26/23',\n",
    " '2/27/23'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "8e2ac8b9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fips</th>\n",
       "      <th>county</th>\n",
       "      <th>state</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "      <th>date</th>\n",
       "      <th>cases</th>\n",
       "      <th>state_code</th>\n",
       "      <th>deaths</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-23</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-24</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-25</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-26</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     fips   county    state        lat       long        date  cases  \\\n",
       "0  1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-22      0   \n",
       "1  1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-23      0   \n",
       "2  1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-24      0   \n",
       "3  1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-25      0   \n",
       "4  1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-26      0   \n",
       "\n",
       "  state_code  deaths  \n",
       "0         AL       0  \n",
       "1         AL       0  \n",
       "2         AL       0  \n",
       "3         AL       0  \n",
       "4         AL       0  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1018b1e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases.rename(columns = {'fips':'county_code'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "83d546c8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "county\n",
      "state_code\n"
     ]
    }
   ],
   "source": [
    "for col in death_cases.columns.tolist():\n",
    "  weird = (death_cases[[col]].applymap(type) != death_cases[[col]].iloc[0].apply(type)).any(axis = 1)\n",
    "  if len (death_cases[weird]) > 0:\n",
    "    print (col)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "7afab1fe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "county_code    float64\n",
       "county          object\n",
       "state           object\n",
       "lat            float64\n",
       "long           float64\n",
       "date            object\n",
       "cases            int64\n",
       "state_code      object\n",
       "deaths           int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "95f502d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases['county'] = death_cases['county'].astype(str)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "792e2558",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases['state_code'] = death_cases['state_code'].astype(str)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "c0c06494",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases = death_cases.drop(death_cases[death_cases['county_code'] == 'AL'].index)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "911cb4d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases['county_code'] = death_cases['county_code'].astype(float)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "c4d90913",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "county_code    10810\n",
       "county             0\n",
       "state              0\n",
       "lat                0\n",
       "long               0\n",
       "date               0\n",
       "cases              0\n",
       "state_code         0\n",
       "deaths             0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "e6071607",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases.dropna(inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "fd8cc37c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "county_code    0\n",
       "county         0\n",
       "state          0\n",
       "lat            0\n",
       "long           0\n",
       "date           0\n",
       "cases          0\n",
       "state_code     0\n",
       "deaths         0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "ab3ff841",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county_code</th>\n",
       "      <th>county</th>\n",
       "      <th>state</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "      <th>date</th>\n",
       "      <th>cases</th>\n",
       "      <th>state_code</th>\n",
       "      <th>deaths</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [county_code, county, state, lat, long, date, cases, state_code, deaths]\n",
       "Index: []"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_dups = death_cases[death_cases.duplicated()]\n",
    "df_dups.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "a743f447",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county_code</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "      <th>cases</th>\n",
       "      <th>deaths</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>3.601892e+06</td>\n",
       "      <td>3.601892e+06</td>\n",
       "      <td>3.601892e+06</td>\n",
       "      <td>3.601892e+06</td>\n",
       "      <td>3.601892e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>3.304308e+04</td>\n",
       "      <td>3.673589e+01</td>\n",
       "      <td>-8.865793e+01</td>\n",
       "      <td>1.311250e+04</td>\n",
       "      <td>1.785856e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>1.864601e+04</td>\n",
       "      <td>9.045343e+00</td>\n",
       "      <td>2.167328e+01</td>\n",
       "      <td>5.957165e+04</td>\n",
       "      <td>7.502301e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>6.000000e+01</td>\n",
       "      <td>-1.427100e+01</td>\n",
       "      <td>-1.741596e+02</td>\n",
       "      <td>-3.073000e+03</td>\n",
       "      <td>-8.200000e+01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>1.907650e+04</td>\n",
       "      <td>3.389559e+01</td>\n",
       "      <td>-9.778561e+01</td>\n",
       "      <td>2.800000e+02</td>\n",
       "      <td>3.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>3.101200e+04</td>\n",
       "      <td>3.799998e+01</td>\n",
       "      <td>-8.948150e+01</td>\n",
       "      <td>2.076000e+03</td>\n",
       "      <td>3.400000e+01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>4.712950e+04</td>\n",
       "      <td>4.159110e+01</td>\n",
       "      <td>-8.231545e+01</td>\n",
       "      <td>7.496000e+03</td>\n",
       "      <td>1.150000e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>9.999900e+04</td>\n",
       "      <td>6.931479e+01</td>\n",
       "      <td>1.456739e+02</td>\n",
       "      <td>3.691301e+06</td>\n",
       "      <td>3.525000e+04</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        county_code           lat          long         cases        deaths\n",
       "count  3.601892e+06  3.601892e+06  3.601892e+06  3.601892e+06  3.601892e+06\n",
       "mean   3.304308e+04  3.673589e+01 -8.865793e+01  1.311250e+04  1.785856e+02\n",
       "std    1.864601e+04  9.045343e+00  2.167328e+01  5.957165e+04  7.502301e+02\n",
       "min    6.000000e+01 -1.427100e+01 -1.741596e+02 -3.073000e+03 -8.200000e+01\n",
       "25%    1.907650e+04  3.389559e+01 -9.778561e+01  2.800000e+02  3.000000e+00\n",
       "50%    3.101200e+04  3.799998e+01 -8.948150e+01  2.076000e+03  3.400000e+01\n",
       "75%    4.712950e+04  4.159110e+01 -8.231545e+01  7.496000e+03  1.150000e+02\n",
       "max    9.999900e+04  6.931479e+01  1.456739e+02  3.691301e+06  3.525000e+04"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "d28295a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases.to_csv(r\"C:\\Users\\tamar\\Desktop\\career foundry\\part 7\\archive\\death_cases.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "30d38af8",
   "metadata": {},
   "outputs": [],
   "source": [
    "##Importing us_country dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "e0f95419",
   "metadata": {},
   "outputs": [],
   "source": [
    "gender_us=pd.read_csv(r\"C:\\Users\\tamar\\Desktop\\career foundry\\part 7\\archive\\us_county.csv\",index_col=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "4b620b4a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fips</th>\n",
       "      <th>county</th>\n",
       "      <th>state</th>\n",
       "      <th>state_code</th>\n",
       "      <th>male</th>\n",
       "      <th>female</th>\n",
       "      <th>median_age</th>\n",
       "      <th>population</th>\n",
       "      <th>female_percentage</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1001</td>\n",
       "      <td>Autauga County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>32.534923</td>\n",
       "      <td>-86.642730</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1003</td>\n",
       "      <td>Baldwin County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>101188</td>\n",
       "      <td>106919</td>\n",
       "      <td>42.8</td>\n",
       "      <td>208107</td>\n",
       "      <td>51.376936</td>\n",
       "      <td>30.727479</td>\n",
       "      <td>-87.722564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1005</td>\n",
       "      <td>Barbour County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>13697</td>\n",
       "      <td>12085</td>\n",
       "      <td>39.9</td>\n",
       "      <td>25782</td>\n",
       "      <td>46.873788</td>\n",
       "      <td>31.869581</td>\n",
       "      <td>-85.393210</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1007</td>\n",
       "      <td>Bibb County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>12152</td>\n",
       "      <td>10375</td>\n",
       "      <td>39.9</td>\n",
       "      <td>22527</td>\n",
       "      <td>46.055844</td>\n",
       "      <td>32.998628</td>\n",
       "      <td>-87.126475</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1009</td>\n",
       "      <td>Blount County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>28434</td>\n",
       "      <td>29211</td>\n",
       "      <td>40.8</td>\n",
       "      <td>57645</td>\n",
       "      <td>50.673953</td>\n",
       "      <td>33.980869</td>\n",
       "      <td>-86.567380</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   fips          county    state state_code    male  female  median_age  \\\n",
       "0  1001  Autauga County  Alabama         AL   26874   28326        37.8   \n",
       "1  1003  Baldwin County  Alabama         AL  101188  106919        42.8   \n",
       "2  1005  Barbour County  Alabama         AL   13697   12085        39.9   \n",
       "3  1007     Bibb County  Alabama         AL   12152   10375        39.9   \n",
       "4  1009   Blount County  Alabama         AL   28434   29211        40.8   \n",
       "\n",
       "   population  female_percentage        lat       long  \n",
       "0       55200          51.315217  32.534923 -86.642730  \n",
       "1      208107          51.376936  30.727479 -87.722564  \n",
       "2       25782          46.873788  31.869581 -85.393210  \n",
       "3       22527          46.055844  32.998628 -87.126475  \n",
       "4       57645          50.673953  33.980869 -86.567380  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gender_us.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "be78616d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3220, 11)"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gender_us.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "c18263d8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fips</th>\n",
       "      <th>male</th>\n",
       "      <th>female</th>\n",
       "      <th>median_age</th>\n",
       "      <th>population</th>\n",
       "      <th>female_percentage</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>3220.000000</td>\n",
       "      <td>3.220000e+03</td>\n",
       "      <td>3.220000e+03</td>\n",
       "      <td>3220.000000</td>\n",
       "      <td>3.220000e+03</td>\n",
       "      <td>3220.000000</td>\n",
       "      <td>3220.000000</td>\n",
       "      <td>3220.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>31393.605280</td>\n",
       "      <td>4.987486e+04</td>\n",
       "      <td>5.145743e+04</td>\n",
       "      <td>41.277516</td>\n",
       "      <td>1.013323e+05</td>\n",
       "      <td>49.961246</td>\n",
       "      <td>37.966287</td>\n",
       "      <td>-91.641071</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>16292.078954</td>\n",
       "      <td>1.601656e+05</td>\n",
       "      <td>1.659688e+05</td>\n",
       "      <td>5.356761</td>\n",
       "      <td>3.260964e+05</td>\n",
       "      <td>2.374927</td>\n",
       "      <td>6.095580</td>\n",
       "      <td>13.311311</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1001.000000</td>\n",
       "      <td>3.800000e+01</td>\n",
       "      <td>3.700000e+01</td>\n",
       "      <td>21.700000</td>\n",
       "      <td>7.500000e+01</td>\n",
       "      <td>21.003945</td>\n",
       "      <td>17.981964</td>\n",
       "      <td>-164.027212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>19032.500000</td>\n",
       "      <td>5.657500e+03</td>\n",
       "      <td>5.573000e+03</td>\n",
       "      <td>38.100000</td>\n",
       "      <td>1.121425e+04</td>\n",
       "      <td>49.433348</td>\n",
       "      <td>34.353322</td>\n",
       "      <td>-98.086128</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>30024.000000</td>\n",
       "      <td>1.291650e+04</td>\n",
       "      <td>1.299650e+04</td>\n",
       "      <td>41.200000</td>\n",
       "      <td>2.595050e+04</td>\n",
       "      <td>50.415031</td>\n",
       "      <td>38.212520</td>\n",
       "      <td>-89.945290</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>46105.500000</td>\n",
       "      <td>3.324850e+04</td>\n",
       "      <td>3.353075e+04</td>\n",
       "      <td>44.300000</td>\n",
       "      <td>6.655225e+04</td>\n",
       "      <td>51.149548</td>\n",
       "      <td>41.694910</td>\n",
       "      <td>-82.992494</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>72153.000000</td>\n",
       "      <td>4.976788e+06</td>\n",
       "      <td>5.121264e+06</td>\n",
       "      <td>67.000000</td>\n",
       "      <td>1.009805e+07</td>\n",
       "      <td>58.613660</td>\n",
       "      <td>69.312150</td>\n",
       "      <td>-65.286183</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               fips          male        female   median_age    population  \\\n",
       "count   3220.000000  3.220000e+03  3.220000e+03  3220.000000  3.220000e+03   \n",
       "mean   31393.605280  4.987486e+04  5.145743e+04    41.277516  1.013323e+05   \n",
       "std    16292.078954  1.601656e+05  1.659688e+05     5.356761  3.260964e+05   \n",
       "min     1001.000000  3.800000e+01  3.700000e+01    21.700000  7.500000e+01   \n",
       "25%    19032.500000  5.657500e+03  5.573000e+03    38.100000  1.121425e+04   \n",
       "50%    30024.000000  1.291650e+04  1.299650e+04    41.200000  2.595050e+04   \n",
       "75%    46105.500000  3.324850e+04  3.353075e+04    44.300000  6.655225e+04   \n",
       "max    72153.000000  4.976788e+06  5.121264e+06    67.000000  1.009805e+07   \n",
       "\n",
       "       female_percentage          lat         long  \n",
       "count        3220.000000  3220.000000  3220.000000  \n",
       "mean           49.961246    37.966287   -91.641071  \n",
       "std             2.374927     6.095580    13.311311  \n",
       "min            21.003945    17.981964  -164.027212  \n",
       "25%            49.433348    34.353322   -98.086128  \n",
       "50%            50.415031    38.212520   -89.945290  \n",
       "75%            51.149548    41.694910   -82.992494  \n",
       "max            58.613660    69.312150   -65.286183  "
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gender_us.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "024d94a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "gender_us.rename(columns = {'fips':'county_code'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "25e42283",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "county_code            int64\n",
       "county                object\n",
       "state                 object\n",
       "state_code            object\n",
       "male                   int64\n",
       "female                 int64\n",
       "median_age           float64\n",
       "population             int64\n",
       "female_percentage    float64\n",
       "lat                  float64\n",
       "long                 float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "gender_us.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "31d938a2",
   "metadata": {},
   "outputs": [],
   "source": [
    "gender_us['state_code'] = gender_us['state_code'].astype(str)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "e10e8ede",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "county_code          0\n",
       "county               0\n",
       "state                0\n",
       "state_code           0\n",
       "male                 0\n",
       "female               0\n",
       "median_age           0\n",
       "population           0\n",
       "female_percentage    0\n",
       "lat                  0\n",
       "long                 0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gender_us.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "0b96cd09",
   "metadata": {},
   "outputs": [],
   "source": [
    "gender_us=gender_us.drop_duplicates()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "10a59a68",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3220, 11)"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gender_us.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "52c6cadb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county_code</th>\n",
       "      <th>male</th>\n",
       "      <th>female</th>\n",
       "      <th>median_age</th>\n",
       "      <th>population</th>\n",
       "      <th>female_percentage</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>3220.000000</td>\n",
       "      <td>3.220000e+03</td>\n",
       "      <td>3.220000e+03</td>\n",
       "      <td>3220.000000</td>\n",
       "      <td>3.220000e+03</td>\n",
       "      <td>3220.000000</td>\n",
       "      <td>3220.000000</td>\n",
       "      <td>3220.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>31393.605280</td>\n",
       "      <td>4.987486e+04</td>\n",
       "      <td>5.145743e+04</td>\n",
       "      <td>41.277516</td>\n",
       "      <td>1.013323e+05</td>\n",
       "      <td>49.961246</td>\n",
       "      <td>37.966287</td>\n",
       "      <td>-91.641071</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>16292.078954</td>\n",
       "      <td>1.601656e+05</td>\n",
       "      <td>1.659688e+05</td>\n",
       "      <td>5.356761</td>\n",
       "      <td>3.260964e+05</td>\n",
       "      <td>2.374927</td>\n",
       "      <td>6.095580</td>\n",
       "      <td>13.311311</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1001.000000</td>\n",
       "      <td>3.800000e+01</td>\n",
       "      <td>3.700000e+01</td>\n",
       "      <td>21.700000</td>\n",
       "      <td>7.500000e+01</td>\n",
       "      <td>21.003945</td>\n",
       "      <td>17.981964</td>\n",
       "      <td>-164.027212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>19032.500000</td>\n",
       "      <td>5.657500e+03</td>\n",
       "      <td>5.573000e+03</td>\n",
       "      <td>38.100000</td>\n",
       "      <td>1.121425e+04</td>\n",
       "      <td>49.433348</td>\n",
       "      <td>34.353322</td>\n",
       "      <td>-98.086128</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>30024.000000</td>\n",
       "      <td>1.291650e+04</td>\n",
       "      <td>1.299650e+04</td>\n",
       "      <td>41.200000</td>\n",
       "      <td>2.595050e+04</td>\n",
       "      <td>50.415031</td>\n",
       "      <td>38.212520</td>\n",
       "      <td>-89.945290</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>46105.500000</td>\n",
       "      <td>3.324850e+04</td>\n",
       "      <td>3.353075e+04</td>\n",
       "      <td>44.300000</td>\n",
       "      <td>6.655225e+04</td>\n",
       "      <td>51.149548</td>\n",
       "      <td>41.694910</td>\n",
       "      <td>-82.992494</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>72153.000000</td>\n",
       "      <td>4.976788e+06</td>\n",
       "      <td>5.121264e+06</td>\n",
       "      <td>67.000000</td>\n",
       "      <td>1.009805e+07</td>\n",
       "      <td>58.613660</td>\n",
       "      <td>69.312150</td>\n",
       "      <td>-65.286183</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        county_code          male        female   median_age    population  \\\n",
       "count   3220.000000  3.220000e+03  3.220000e+03  3220.000000  3.220000e+03   \n",
       "mean   31393.605280  4.987486e+04  5.145743e+04    41.277516  1.013323e+05   \n",
       "std    16292.078954  1.601656e+05  1.659688e+05     5.356761  3.260964e+05   \n",
       "min     1001.000000  3.800000e+01  3.700000e+01    21.700000  7.500000e+01   \n",
       "25%    19032.500000  5.657500e+03  5.573000e+03    38.100000  1.121425e+04   \n",
       "50%    30024.000000  1.291650e+04  1.299650e+04    41.200000  2.595050e+04   \n",
       "75%    46105.500000  3.324850e+04  3.353075e+04    44.300000  6.655225e+04   \n",
       "max    72153.000000  4.976788e+06  5.121264e+06    67.000000  1.009805e+07   \n",
       "\n",
       "       female_percentage          lat         long  \n",
       "count        3220.000000  3220.000000  3220.000000  \n",
       "mean           49.961246    37.966287   -91.641071  \n",
       "std             2.374927     6.095580    13.311311  \n",
       "min            21.003945    17.981964  -164.027212  \n",
       "25%            49.433348    34.353322   -98.086128  \n",
       "50%            50.415031    38.212520   -89.945290  \n",
       "75%            51.149548    41.694910   -82.992494  \n",
       "max            58.613660    69.312150   -65.286183  "
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gender_us.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "1b751b9e",
   "metadata": {},
   "outputs": [],
   "source": [
    "gender_us['county_code'] = gender_us['county_code'].astype(float)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "68edddb4",
   "metadata": {},
   "outputs": [],
   "source": [
    "##Mearging datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "9be52f03",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender = death_cases.merge(gender_us, on = 'county_code',indicator=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "c0ba25c9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3480820, 20)"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases_gender.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "d3e7702c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county_code</th>\n",
       "      <th>county_x</th>\n",
       "      <th>state_x</th>\n",
       "      <th>lat_x</th>\n",
       "      <th>long_x</th>\n",
       "      <th>date</th>\n",
       "      <th>cases</th>\n",
       "      <th>state_code_x</th>\n",
       "      <th>deaths</th>\n",
       "      <th>county_y</th>\n",
       "      <th>state_y</th>\n",
       "      <th>state_code_y</th>\n",
       "      <th>male</th>\n",
       "      <th>female</th>\n",
       "      <th>median_age</th>\n",
       "      <th>population</th>\n",
       "      <th>female_percentage</th>\n",
       "      <th>lat_y</th>\n",
       "      <th>long_y</th>\n",
       "      <th>_merge</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>Autauga County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>32.534923</td>\n",
       "      <td>-86.64273</td>\n",
       "      <td>both</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-23</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>Autauga County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>32.534923</td>\n",
       "      <td>-86.64273</td>\n",
       "      <td>both</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-24</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>Autauga County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>32.534923</td>\n",
       "      <td>-86.64273</td>\n",
       "      <td>both</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-25</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>Autauga County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>32.534923</td>\n",
       "      <td>-86.64273</td>\n",
       "      <td>both</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-26</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>Autauga County</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>AL</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>32.534923</td>\n",
       "      <td>-86.64273</td>\n",
       "      <td>both</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   county_code county_x  state_x      lat_x     long_x        date  cases  \\\n",
       "0       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-22      0   \n",
       "1       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-23      0   \n",
       "2       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-24      0   \n",
       "3       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-25      0   \n",
       "4       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-26      0   \n",
       "\n",
       "  state_code_x  deaths        county_y  state_y state_code_y   male  female  \\\n",
       "0           AL       0  Autauga County  Alabama           AL  26874   28326   \n",
       "1           AL       0  Autauga County  Alabama           AL  26874   28326   \n",
       "2           AL       0  Autauga County  Alabama           AL  26874   28326   \n",
       "3           AL       0  Autauga County  Alabama           AL  26874   28326   \n",
       "4           AL       0  Autauga County  Alabama           AL  26874   28326   \n",
       "\n",
       "   median_age  population  female_percentage      lat_y    long_y _merge  \n",
       "0        37.8       55200          51.315217  32.534923 -86.64273   both  \n",
       "1        37.8       55200          51.315217  32.534923 -86.64273   both  \n",
       "2        37.8       55200          51.315217  32.534923 -86.64273   both  \n",
       "3        37.8       55200          51.315217  32.534923 -86.64273   both  \n",
       "4        37.8       55200          51.315217  32.534923 -86.64273   both  "
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases_gender.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "83bbc5ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender = death_cases_gender.drop(columns= ['county_y','state_y','state_code_y','lat_y','long_y','_merge'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "c609b890",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender.rename(columns = {'county_x' : 'county'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "7d1d1e76",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender.rename(columns = {'state_x' : 'state'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "82814c1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender.rename(columns = {'lat_x' : 'lat'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "b7192b06",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender.rename(columns = {'long_x' : 'long'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "a8e2e2ec",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender.rename(columns = {'state_code_x' : 'state_code'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "06255a56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county_code</th>\n",
       "      <th>county</th>\n",
       "      <th>state</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "      <th>date</th>\n",
       "      <th>cases</th>\n",
       "      <th>state_code</th>\n",
       "      <th>deaths</th>\n",
       "      <th>male</th>\n",
       "      <th>female</th>\n",
       "      <th>median_age</th>\n",
       "      <th>population</th>\n",
       "      <th>female_percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-23</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-24</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-25</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-26</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   county_code   county    state        lat       long        date  cases  \\\n",
       "0       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-22      0   \n",
       "1       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-23      0   \n",
       "2       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-24      0   \n",
       "3       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-25      0   \n",
       "4       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-26      0   \n",
       "\n",
       "  state_code  deaths   male  female  median_age  population  female_percentage  \n",
       "0         AL       0  26874   28326        37.8       55200          51.315217  \n",
       "1         AL       0  26874   28326        37.8       55200          51.315217  \n",
       "2         AL       0  26874   28326        37.8       55200          51.315217  \n",
       "3         AL       0  26874   28326        37.8       55200          51.315217  \n",
       "4         AL       0  26874   28326        37.8       55200          51.315217  "
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases_gender.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "135ecd9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "result = [] \n",
    "northeast = ['Maine', 'New Hampshire', 'Vermont','Massachusetts', 'Rhode Island', 'Connecticut', 'New York', 'Pennsylvania', 'New Jersey']\n",
    "midwest = ['Wisconsin','Michigan','Illinois','Indiana','Ohio','North Dakota','South Dakota','Nebraska','Kansas','Minnesota','Iowa', 'Missouri']\n",
    "south = ['Delaware','Maryland', 'District of Columbia', 'Virginia', 'West Virginia','North Carolina','South Carolina', 'Georgia', 'Florida', 'Kentucky', 'Tennessee', 'Mississippi','Alabama','Oklahoma','Texas','Arkansas','Louisiana']\n",
    "west = ['Idaho', 'Montana','Wyoming','Nevada','Utah','Colorado','Arizona','New Mexico','Alaska','Washington','Oregon','California','Hawaii']\n",
    "\n",
    "for value in death_cases_gender['state']:\n",
    "    if value in northeast:\n",
    "        result.append(\"Northeast\")\n",
    "    elif value in midwest:\n",
    "        result.append(\"Midwest\")\n",
    "    elif value in south:\n",
    "        result.append(\"South\")\n",
    "    else:\n",
    "        result.append(\"West\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "08a5010d",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender['region'] = result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "52464041",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county_code</th>\n",
       "      <th>county</th>\n",
       "      <th>state</th>\n",
       "      <th>lat</th>\n",
       "      <th>long</th>\n",
       "      <th>date</th>\n",
       "      <th>cases</th>\n",
       "      <th>state_code</th>\n",
       "      <th>deaths</th>\n",
       "      <th>male</th>\n",
       "      <th>female</th>\n",
       "      <th>median_age</th>\n",
       "      <th>population</th>\n",
       "      <th>female_percentage</th>\n",
       "      <th>region</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-22</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>South</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-23</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>South</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-24</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>South</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-25</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>South</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1001.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.539527</td>\n",
       "      <td>-86.644082</td>\n",
       "      <td>2020-01-26</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>0</td>\n",
       "      <td>26874</td>\n",
       "      <td>28326</td>\n",
       "      <td>37.8</td>\n",
       "      <td>55200</td>\n",
       "      <td>51.315217</td>\n",
       "      <td>South</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   county_code   county    state        lat       long        date  cases  \\\n",
       "0       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-22      0   \n",
       "1       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-23      0   \n",
       "2       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-24      0   \n",
       "3       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-25      0   \n",
       "4       1001.0  Autauga  Alabama  32.539527 -86.644082  2020-01-26      0   \n",
       "\n",
       "  state_code  deaths   male  female  median_age  population  \\\n",
       "0         AL       0  26874   28326        37.8       55200   \n",
       "1         AL       0  26874   28326        37.8       55200   \n",
       "2         AL       0  26874   28326        37.8       55200   \n",
       "3         AL       0  26874   28326        37.8       55200   \n",
       "4         AL       0  26874   28326        37.8       55200   \n",
       "\n",
       "   female_percentage region  \n",
       "0          51.315217  South  \n",
       "1          51.315217  South  \n",
       "2          51.315217  South  \n",
       "3          51.315217  South  \n",
       "4          51.315217  South  "
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "death_cases_gender.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "c0ea69eb",
   "metadata": {},
   "outputs": [],
   "source": [
    "death_cases_gender.to_csv(r\"C:\\Users\\tamar\\Desktop\\career foundry\\part 7\\archive\\death_cases_gender.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c5c323c5",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9339e17f",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cf7423c3",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e41c0ff",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
